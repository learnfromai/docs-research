# Implementation Guide: Security Scanning & Vulnerability Assessment

## 🚀 Getting Started

This comprehensive implementation guide provides step-by-step instructions for integrating SAST, DAST, and dependency scanning into your development workflow. The guide is structured for progressive implementation, allowing teams to start with basic tools and gradually enhance their security posture.

## 🎯 Implementation Phases

### Phase 1: Foundation (Week 1-2)
**Objective**: Establish basic security scanning capabilities
**Tools**: SonarQube Community, GitHub Dependabot, ESLint Security
**Investment**: $0 - $50/month

### Phase 2: Integration (Week 3-4) 
**Objective**: Automate security scanning in CI/CD pipelines
**Tools**: GitHub Actions, OWASP ZAP, basic DAST
**Investment**: $0 - $200/month

### Phase 3: Enhancement (Month 2-3)
**Objective**: Advanced scanning and comprehensive coverage
**Tools**: Commercial DAST, enhanced SAST, container scanning
**Investment**: $500 - $2,000/month

### Phase 4: Optimization (Month 4-6)
**Objective**: Fine-tuning, compliance, and advanced threat detection
**Tools**: Platform consolidation, compliance reporting
**Investment**: $1,000 - $8,000/month

## 📋 Phase 1: Foundation Setup

### 1.1 SonarQube Community Edition Setup

**Prerequisites**:
- Docker installed on your system
- Java 17+ for local development
- Admin access to your Git repository

**Step 1: Docker Installation**
```bash
# Create docker-compose.yml for SonarQube
version: '3.8'
services:
  sonarqube:
    image: sonarqube:community
    depends_on:
      - db
    environment:
      SONAR_JDBC_URL: jdbc:postgresql://db:5432/sonar
      SONAR_JDBC_USERNAME: sonar
      SONAR_JDBC_PASSWORD: sonar
    volumes:
      - sonarqube_data:/opt/sonarqube/data
      - sonarqube_extensions:/opt/sonarqube/extensions
      - sonarqube_logs:/opt/sonarqube/logs
    ports:
      - "9000:9000"
    platform: linux/amd64
  
  db:
    image: postgres:15
    environment:
      POSTGRES_USER: sonar
      POSTGRES_PASSWORD: sonar
      POSTGRES_DB: sonar
    volumes:
      - postgresql:/var/lib/postgresql
      - postgresql_data:/var/lib/postgresql/data

volumes:
  sonarqube_data:
  sonarqube_extensions:
  sonarqube_logs:
  postgresql:
  postgresql_data:
```

**Step 2: Launch SonarQube**
```bash
# Start SonarQube container
docker-compose up -d

# Wait for startup (check logs)
docker-compose logs -f sonarqube

# Access SonarQube at http://localhost:9000
# Default credentials: admin/admin
```

**Step 3: Project Configuration**
```bash
# Install SonarQube Scanner
npm install -g sonarqube-scanner

# Create sonar-project.properties
sonar.projectKey=my-edtech-platform
sonar.projectName=EdTech Platform Security Scan
sonar.projectVersion=1.0
sonar.sources=src
sonar.exclusions=**/node_modules/**,**/dist/**,**/*.test.js
sonar.javascript.lcov.reportPaths=coverage/lcov.info
sonar.typescript.lcov.reportPaths=coverage/lcov.info
```

### 1.2 GitHub Dependabot Configuration

**Step 1: Enable Dependabot**
Create `.github/dependabot.yml`:
```yaml
version: 2
updates:
  # Enable version updates for npm
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "09:00"
    reviewers:
      - "security-team"
    assignees:
      - "lead-developer"
    commit-message:
      prefix: "deps"
      include: "scope"
    
  # Enable security updates for Docker
  - package-ecosystem: "docker"
    directory: "/docker"
    schedule:
      interval: "weekly"
    
  # Enable updates for GitHub Actions
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "monthly"
```

**Step 2: Configure Security Alerts**
```bash
# Enable Dependabot security updates via GitHub CLI
gh repo edit --enable-vulnerability-alerts
gh repo edit --enable-automated-security-fixes

# Or via GitHub web interface:
# Settings → Security & analysis → Dependabot alerts (Enable)
# Settings → Security & analysis → Dependabot security updates (Enable)
```

### 1.3 ESLint Security Configuration

**Step 1: Install Security Plugins**
```bash
# Install ESLint security plugins
npm install --save-dev \
  eslint-plugin-security \
  eslint-plugin-no-secrets \
  eslint-plugin-anti-trojan-source

# For React projects, also install
npm install --save-dev eslint-plugin-react-security
```

**Step 2: Configure .eslintrc.js**
```javascript
module.exports = {
  extends: [
    'eslint:recommended',
    '@typescript-eslint/recommended',
    'plugin:security/recommended',
    'plugin:react-security/recommended'
  ],
  plugins: [
    'security',
    'no-secrets',
    'anti-trojan-source',
    'react-security'
  ],
  rules: {
    // Security-specific rules
    'security/detect-object-injection': 'error',
    'security/detect-non-literal-regexp': 'error',
    'security/detect-unsafe-regex': 'error',
    'security/detect-buffer-noassert': 'error',
    'security/detect-child-process': 'error',
    'security/detect-disable-mustache-escape': 'error',
    'security/detect-eval-with-expression': 'error',
    'security/detect-no-csrf-before-method-override': 'error',
    'security/detect-non-literal-fs': 'warn',
    'security/detect-non-literal-require': 'warn',
    'security/detect-possible-timing-attacks': 'error',
    'security/detect-pseudoRandomBytes': 'error',
    
    // Secrets detection
    'no-secrets/no-secrets': ['error', {
      'tolerance': 4.2,
      'additionalRegexes': {
        'Basic Auth': 'Basic [A-Za-z0-9+/]+=*',
        'JWT': 'ey[A-Za-z0-9-_=]+\\.[A-Za-z0-9-_=]+\\.?[A-Za-z0-9-_.+/=]*'
      }
    }],
    
    // Anti-trojan source
    'anti-trojan-source/no-bidi': 'error'
  }
};
```

## 📋 Phase 2: CI/CD Integration

### 2.1 GitHub Actions Security Workflow

**Step 1: Create Security Workflow**
Create `.github/workflows/security.yml`:
```yaml
name: Security Scan

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  schedule:
    # Run security scan daily at 2 AM
    - cron: '0 2 * * *'

jobs:
  sast-scan:
    name: Static Application Security Testing
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
      with:
        fetch-depth: 0  # Full history for better analysis
    
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
    
    - name: Install dependencies
      run: npm ci
    
    - name: Run ESLint Security Check
      run: npx eslint . --ext .js,.jsx,.ts,.tsx --format sarif --output-file eslint-results.sarif
      continue-on-error: true
    
    - name: Upload ESLint results to GitHub
      uses: github/codeql-action/upload-sarif@v3
      with:
        sarif_file: eslint-results.sarif
        wait-for-processing: true
    
    - name: SonarQube Scan
      uses: sonarqube-quality-gate-action@master
      env:
        SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
        SONAR_HOST_URL: ${{ secrets.SONAR_HOST_URL }}
    
    - name: Run Tests with Coverage
      run: npm run test:coverage
    
    - name: SonarQube Quality Gate Check
      uses: sonarqube-quality-gate-action@master
      env:
        SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}

  dependency-scan:
    name: Dependency Vulnerability Scan
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: Run Snyk to check for vulnerabilities
      uses: snyk/actions/node@master
      env:
        SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
      with:
        args: --severity-threshold=high --fail-on=upgradable
    
    - name: Upload result to GitHub Code Scanning
      uses: github/codeql-action/upload-sarif@v3
      with:
        sarif_file: snyk.sarif

  container-scan:
    name: Container Security Scan
    runs-on: ubuntu-latest
    if: github.event_name == 'push'
    steps:
    - uses: actions/checkout@v4
    
    - name: Build Docker image
      run: docker build -t edtech-platform:${{ github.sha }} .
    
    - name: Run Trivy vulnerability scanner
      uses: aquasecurity/trivy-action@master
      with:
        image-ref: 'edtech-platform:${{ github.sha }}'
        format: 'sarif'
        output: 'trivy-results.sarif'
    
    - name: Upload Trivy scan results to GitHub Security tab
      uses: github/codeql-action/upload-sarif@v3
      with:
        sarif_file: 'trivy-results.sarif'
```

### 2.2 OWASP ZAP Integration

**Step 1: Add DAST to Workflow**
Add to `.github/workflows/security.yml`:
```yaml
  dast-scan:
    name: Dynamic Application Security Testing
    runs-on: ubuntu-latest
    if: github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'
    services:
      app:
        image: node:18
        ports:
          - 3000:3000
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Application
      run: |
        npm ci
        npm run build
        npm start &
        sleep 30  # Wait for app to start
    
    - name: OWASP ZAP Baseline Scan
      uses: zaproxy/action-baseline@v0.10.0
      with:
        target: 'http://localhost:3000'
        rules_file_name: '.zap/rules.tsv'
        cmd_options: '-a -j -m 5 -T 60'
    
    - name: Create SARIF file from ZAP results
      run: |
        python3 -c "
        import json, sys
        with open('report_json.json') as f:
            zap_data = json.load(f)
        # Convert ZAP JSON to SARIF format
        # Implementation details in template-examples.md
        "
    
    - name: Upload DAST results
      uses: github/codeql-action/upload-sarif@v3
      with:
        sarif_file: 'zap-results.sarif'
```

**Step 2: ZAP Configuration**
Create `.zap/rules.tsv`:
```tsv
10011	IGNORE	(XSS Protection Not Enabled)
10020	IGNORE	(X-Frame-Options Not Set)
10021	IGNORE	(X-Content-Type-Options Not Set)
90022	IGNORE	(Application Error Disclosure)
```

## 📋 Phase 3: Advanced Implementation

### 3.1 Commercial DAST Integration

**Burp Suite Professional Integration**
```yaml
# .github/workflows/advanced-security.yml
  advanced-dast:
    name: Advanced DAST with Burp Suite
    runs-on: ubuntu-latest
    steps:
    - name: Download Burp Suite
      run: |
        curl -o burpsuite.jar "https://portswigger.net/burp/releases/download?product=pro&version=2023.10.3.4&type=Jar"
    
    - name: Run Burp Suite Scan
      run: |
        java -jar burpsuite.jar --config-file=burp-config.json \
             --target-url=https://staging.edtech-platform.com \
             --output-file=burp-results.xml
    
    - name: Convert Burp results to SARIF
      run: python3 scripts/burp-to-sarif.py burp-results.xml > burp-results.sarif
    
    - name: Upload results
      uses: github/codeql-action/upload-sarif@v3
      with:
        sarif_file: 'burp-results.sarif'
```

### 3.2 Container Security with Twistlock/Prisma Cloud

**Step 1: Container Registry Scanning**
```yaml
  container-registry-scan:
    name: Container Registry Security Scan
    runs-on: ubuntu-latest
    steps:
    - name: Prisma Cloud Scan
      run: |
        docker pull paloaltonetworks/twistcli
        docker run --rm \
          -v $(pwd):/app \
          paloaltonetworks/twistcli \
          images scan \
          --address ${{ secrets.PRISMA_CLOUD_COMPUTE_URL }} \
          --user ${{ secrets.PRISMA_CLOUD_ACCESS_KEY }} \
          --password ${{ secrets.PRISMA_CLOUD_SECRET_KEY }} \
          --details \
          edtech-platform:latest
```

### 3.3 Advanced SAST with CodeQL

**Step 1: Enable GitHub Advanced Security**
```yaml
# .github/workflows/codeql-analysis.yml
name: "Code Scanning - Action"

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: '30 1 * * 0'

jobs:
  CodeQL-Build:
    runs-on: ubuntu-latest
    permissions:
      actions: read
      contents: read
      security-events: write
    
    strategy:
      fail-fast: false
      matrix:
        language: [ 'javascript', 'typescript' ]
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
    
    - name: Initialize CodeQL
      uses: github/codeql-action/init@v3
      with:
        languages: ${{ matrix.language }}
        config-file: ./.github/codeql/codeql-config.yml
    
    - name: Autobuild
      uses: github/codeql-action/autobuild@v3
    
    - name: Perform CodeQL Analysis
      uses: github/codeql-action/analyze@v3
      with:
        category: "/language:${{matrix.language}}"
```

**Step 2: Custom CodeQL Configuration**
Create `.github/codeql/codeql-config.yml`:
```yaml
name: "EdTech Security CodeQL Config"

disable-default-queries: false

queries:
  - name: security-queries
    uses: security-and-quality
  - name: custom-queries
    uses: ./.github/codeql/custom-queries/

packs:
  - codeql/javascript-queries
  - codeql/javascript-security-queries

paths-ignore:
  - node_modules
  - dist
  - build
  - '**/*.test.js'
  - '**/*.spec.ts'

paths:
  - src
  - pages
  - components
  - lib
```

## 🔧 Tool Configuration Examples

### SonarQube Quality Gates
```javascript
// sonar-project.js - Advanced configuration
const scanner = require('sonarqube-scanner');

scanner({
  serverUrl: process.env.SONAR_HOST_URL,
  token: process.env.SONAR_TOKEN,
  options: {
    'sonar.projectKey': 'edtech-platform',
    'sonar.projectName': 'Educational Platform',
    'sonar.projectVersion': process.env.npm_package_version,
    'sonar.sources': 'src',
    'sonar.tests': 'src',
    'sonar.test.inclusions': '**/*.test.js,**/*.spec.ts',
    'sonar.exclusions': '**/node_modules/**,**/dist/**',
    'sonar.javascript.lcov.reportPaths': 'coverage/lcov.info',
    'sonar.typescript.lcov.reportPaths': 'coverage/lcov.info',
    
    // Security-specific settings
    'sonar.security.hotspots.checkTimeout': '300',
    'sonar.security.hotspots.maxIssues': '100',
    
    // Quality gates
    'sonar.qualitygate.wait': 'true',
    'sonar.qualitygate.timeout': '300',
    
    // Coverage requirements
    'sonar.coverage.exclusions': '**/*.test.js,**/*.spec.ts,**/mocks/**',
    
    // Duplicated lines
    'sonar.cpd.exclusions': '**/generated/**'
  }
});
```

### Snyk Configuration
Create `.snyk` file:
```yaml
# Snyk (https://snyk.io) policy file
version: v1.25.0

# Ignore specific vulnerabilities
ignore:
  'SNYK-JS-LODASH-567746':
    - '*':
        reason: 'No exploit available for our use case'
        expires: '2024-12-31T23:59:59.999Z'

# Patch vulnerabilities
patch: {}

# Language settings
language-settings:
  javascript:
    ignore-missing-files: true
    dev: false
```

## 📊 Monitoring and Alerting

### Security Metrics Dashboard
```yaml
# .github/workflows/security-metrics.yml
name: Security Metrics

on:
  schedule:
    - cron: '0 8 * * MON'  # Weekly on Monday

jobs:
  collect-metrics:
    runs-on: ubuntu-latest
    steps:
    - name: Collect Security Metrics
      run: |
        # Pull metrics from various tools
        curl -H "Authorization: Bearer ${{ secrets.SONAR_TOKEN }}" \
             "${{ secrets.SONAR_HOST_URL }}/api/measures/component?component=edtech-platform&metricKeys=security_hotspots,vulnerabilities" \
             > sonar-metrics.json
        
        # Snyk metrics
        snyk monitor --json > snyk-metrics.json
        
        # GitHub Security metrics
        gh api repos/${{ github.repository }}/vulnerability-alerts \
           --jq '.[] | {severity: .security_advisory.severity, package: .security_vulnerability.package.name}' \
           > github-security-metrics.json
    
    - name: Generate Security Report
      run: python3 scripts/generate-security-report.py
    
    - name: Upload to monitoring system
      run: |
        # Send to monitoring dashboard (Grafana, DataDog, etc.)
        curl -X POST "https://api.datadoghq.com/api/v1/series" \
             -H "Content-Type: application/json" \
             -H "DD-API-KEY: ${{ secrets.DATADOG_API_KEY }}" \
             -d @security-metrics-payload.json
```

## 🚨 Incident Response Integration

### Automated Alert Configuration
```yaml
# .github/workflows/security-alerts.yml
name: Security Alerts

on:
  workflow_run:
    workflows: ["Security Scan"]
    types: [completed]

jobs:
  process-alerts:
    if: ${{ github.event.workflow_run.conclusion == 'failure' }}
    runs-on: ubuntu-latest
    steps:
    - name: Download security results
      uses: actions/download-artifact@v4
      with:
        name: security-results
        run-id: ${{ github.event.workflow_run.id }}
    
    - name: Parse critical vulnerabilities
      run: |
        python3 scripts/parse-security-results.py \
          --critical-only \
          --format slack > critical-vulns.json
    
    - name: Send Slack Alert
      if: success()
      uses: 8398a7/action-slack@v3
      with:
        status: failure
        custom_payload: |
          {
            "channel": "#security-alerts",
            "username": "Security Bot",
            "icon_emoji": ":warning:",
            "attachments": [{
              "color": "danger",
              "title": "Critical Security Vulnerabilities Detected",
              "text": "Review required: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}",
              "fields": ${{ steps.parse.outputs.critical-vulns }}
            }]
          }
      env:
        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
    
    - name: Create GitHub Issue
      run: |
        gh issue create \
          --title "🚨 Critical Security Vulnerabilities - $(date +%Y-%m-%d)" \
          --body-file critical-vulns-issue.md \
          --label "security,critical" \
          --assignee security-team
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

## 🔍 Troubleshooting Common Issues

### SonarQube Common Problems

**Issue**: Quality Gate Failure
```bash
# Debug quality gate issues
curl -u admin:admin \
     "http://localhost:9000/api/qualitygates/project_status?projectKey=edtech-platform" \
     | jq '.'

# Check specific metrics
curl -u admin:admin \
     "http://localhost:9000/api/measures/component?component=edtech-platform&metricKeys=coverage,duplicated_lines_density,bugs,vulnerabilities,code_smells" \
     | jq '.component.measures'
```

**Issue**: Scanner Out of Memory
```bash
# Increase memory for SonarQube scanner
export SONAR_SCANNER_OPTS="-Xmx2048m"
sonar-scanner
```

### OWASP ZAP Common Problems

**Issue**: False Positives
```bash
# Create custom ZAP rules
echo "10021	IGNORE	X-Content-Type-Options header" >> .zap/rules.tsv
echo "10020	IGNORE	X-Frame-Options header" >> .zap/rules.tsv
```

**Issue**: Scan Timeout
```yaml
# Increase timeout in GitHub Actions
- name: OWASP ZAP Full Scan
  uses: zaproxy/action-full-scan@v0.10.0
  with:
    target: 'http://localhost:3000'
    cmd_options: '-T 180'  # 3 minute timeout
```

## 📈 Performance Optimization

### Parallel Scanning
```yaml
# Optimize CI/CD pipeline with parallel jobs
jobs:
  security-scan:
    strategy:
      matrix:
        scan-type: [sast, dast, dependencies, containers]
    runs-on: ubuntu-latest
    steps:
    - name: Run ${{ matrix.scan-type }} scan
      run: scripts/run-${{ matrix.scan-type }}-scan.sh
```

### Incremental Scanning
```bash
# Only scan changed files in PR
git diff --name-only origin/main...HEAD \
  | grep -E '\.(js|ts|jsx|tsx)$' \
  | xargs sonar-scanner -Dsonar.sources=
```

---

## Navigation

| Previous | Next |
|----------|------|
| [← Executive Summary](./executive-summary.md) | [Best Practices →](./best-practices.md) |

### Related Documents
- 🔧 [Tool Selection Guide](./tool-selection-guide.md)
- 💰 [Cost Analysis](./cost-analysis.md)
- 📋 [Template Examples](./template-examples.md)
- 🏛️ [Compliance Frameworks](./compliance-frameworks.md)